<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="selenium之下拉列表,鼠标,键盘操作"><meta name="keywords" content="python,selenium"><meta name="author" content="Grace Soul,undefined"><meta name="copyright" content="Grace Soul"><title>selenium之下拉列表,鼠标,键盘操作【筱茗辰】</title><link rel="stylesheet" href="/css/fan.css"><link rel="stylesheet" href="/css/fan.styl"><link rel="stylesheet" href="/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch-theme-algolia.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4"></script><!-- link(rel="dns-prefetch" href="https://cdn.jsdelivr.net")--><!-- link(rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css")--><!-- script(src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer)--><!-- script(src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML")--><script src="/js/mathjax/mathjax.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('请输入文章密码') !== '') {
        alert('密码错误！');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"9WY0UOLPES","apiKey":"cfaff4a7a2e7c23fdb31ee54941ea39c","indexName":"algolia_index","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容:${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
}</script></head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="toggle-sidebar-info button-hover"><span data-toggle="文章目录">站点概览</span></div><div class="sidebar-toc"><div class="sidebar-toc-title">目录</div><div class="sidebar-toc-progress"><span class="progress-notice">您已阅读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc-progress-bar"></div></div><div class="sidebar-toc-content" id="sidebar-toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#selenium之下拉列表-鼠标-键盘操作"><span class="toc-number">1.</span> <span class="toc-text">selenium之下拉列表,鼠标,键盘操作</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/avatar.png"></div><div class="author-info-name">Grace Soul</div><div class="author-info-description">流浪陌路，暖然绯凉，写意人生，相识一场</div><div class="links-buttons"><a class="links-button button-hover" href="https://github.com/gracesoul" target="_blank">GitHub<i class="icon-dot bg-color6"></i></a><a class="links-button button-hover" href="mailto:18871369054@163.com" target="_blank">E-Mail<i class="icon-dot bg-color3"></i></a><a class="links-button button-hover" href="tencent://message/?uin=1490002855&amp;Site=&amp;Menu=yes" target="_blank">QQ<i class="icon-dot bg-color4"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/archives"><span class="pull-top">日志</span><span class="pull-bottom">20</span></a><a class="author-info-articles-tags article-meta" href="/tags"><span class="pull-top">标签</span><span class="pull-bottom">23</span></a><a class="author-info-articles-categories article-meta" href="/categories"><span class="pull-top">分类</span><span class="pull-bottom">15</span></a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">首页</a><a class="menu-item" href="/tags">标签</a><a class="menu-item" href="/categories">分类</a><a class="menu-item" href="/archives">归档</a><a class="menu-item" href="/about">关于</a></nav><div class="right-info"><a class="search social-icon"><i class="fas fa-search"></i><span> 搜索</span></a><a class="title-name" href="/">筱茗辰</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><div class="post-header"><div class="title">selenium之下拉列表,鼠标,键盘操作</div><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 发表于 2019-06-03 | 更新于 2019-06-04</time><!--time.button-hover.post-date #[i.fas.fa-calendar-alt.article-icon(aria-hidden="true")] #[=__('post.modified')] #[=date(page['updated'], config.date_format)]--><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/selenium-python自动化/">selenium-python自动化</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/python/">python</a><span>&nbsp;|&nbsp;</span><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/selenium/">selenium</a></div></div></div><div class="main-content"><h4 id="selenium之下拉列表-鼠标-键盘操作"><a href="#selenium之下拉列表-鼠标-键盘操作" class="headerlink" title="selenium之下拉列表,鼠标,键盘操作"></a>selenium之下拉列表,鼠标,键盘操作</h4><ol>
<li>下拉列表操作 —&gt; Select类</li>
<li>鼠标操作  —&gt; ActionChains类</li>
<li>键盘操作 —&gt; Key类<a id="more"></a>
</li>
</ol>
<p>selenium当中的元素，有4个基本的操作</p>
<ol>
<li>click() —&gt;点击</li>
<li>send_keys() —-&gt;输入文本</li>
<li>WebElement对象.text —-&gt;获取文本内容</li>
<li>WebElement对象.get_attribute(属性名称) —-&gt;获取属性的值</li>
</ol>
<ol start="4">
<li>详解操作下拉列表<br>下拉列表操作出现的场景：<ol>
<li>select/option<br>引入Select类： from selenium.webdriver.support.ui import Select<br>Select类来处理select/option元素<br>可以通过value，index(下标),text(文本内容)三种方式选择option对应的值。</li>
<li>ui/li<br>鼠标悬浮–》选择下拉列表的数据–》ctrl+shift+c 定位<br>操作流程：</li>
<li>菜单栏-点击其中的某一链接跳转</li>
<li>在下拉列表中选择某一值<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># select/option 部分代码</span></span><br><span class="line">from selenium.webdriver.support.ui import <span class="keyword">Select</span></span><br><span class="line"><span class="keyword">from</span> <span class="built_in">time</span> <span class="keyword">import</span> <span class="keyword">sleep</span></span><br><span class="line"><span class="comment"># 1. 找到select元素对象，实例化Select类。</span></span><br><span class="line">s = <span class="keyword">Select</span>(driver.find_element_by_xpath(<span class="string">'定位代码'</span>))</span><br><span class="line"><span class="comment"># 2. 选择下拉列表的值。</span></span><br><span class="line"><span class="comment"># 2.1 通过value属性值</span></span><br><span class="line">   <span class="keyword">sleep</span>(<span class="number">2</span>)</span><br><span class="line">   s.select_by_value(<span class="string">'value的值'</span>)</span><br><span class="line">   <span class="comment"># 2.2 通过index下标</span></span><br><span class="line">   <span class="keyword">sleep</span>(<span class="number">2</span>)</span><br><span class="line">   s.select_by_index(<span class="number">1</span>) <span class="comment"># 下标从0开始</span></span><br><span class="line"><span class="comment"># 不同点： iframe 下标从1开始</span></span><br><span class="line"><span class="comment"># 2.3 通过text文本内容</span></span><br><span class="line">   <span class="keyword">sleep</span>(<span class="number">2</span>)</span><br><span class="line">   s.select_by_text(<span class="string">'text文本内容'</span>)</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<ol start="5">
<li>详解操作鼠标<br>主要操作流程：<ol>
<li>引入ActionChains类(from selenium.webdriver.common.action_chains import ActionChains)</li>
<li>存储鼠标操作</li>
<li>perform()来执行鼠标操作 这是逻辑（必须要带着 否则无法执行）<br>主要的操作方法：</li>
<li>move_to_element() —&gt;鼠标悬浮</li>
<li>drag_and_drop()   —&gt;拖拽</li>
<li>context_click()   —&gt;右键操作</li>
<li>double_click()    —&gt;双击操作</li>
<li>reset_actions()   —&gt;重置</li>
<li>click_and_hold()  —&gt;按着左键，不松开</li>
<li>click()           —&gt;点击</li>
<li>release()         —&gt;释放(这是实现逻辑，就像perform()函数一样)</li>
<li>send_keys()       —&gt;输入操作</li>
<li>pause()          —&gt;暂停</li>
<li>滚动—&gt;用js实现<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># 前提是： 先找到要操作的元素</span><br><span class="line"># <span class="number">1.</span> 实例化鼠标类</span><br><span class="line"># <span class="number">2.</span> 调用各种鼠标行为</span><br><span class="line"># <span class="number">3.</span> 调用perform()方法去执行鼠标操作</span><br><span class="line"></span><br><span class="line"># 悬浮的数据如何定位？如何定位下拉列表的数据？-----&gt;</span><br><span class="line"><span class="number">1.</span> 执行过程中： f12--&gt;source--&gt;右侧的暂停的图标(使用的场景：定位捕获异常：比如账号密码输入错误，有短暂的弹出提示)</span><br><span class="line"><span class="number">2.</span> ctrl+shift+c(悬浮元素-》选中下拉的数据 -》ctrl+shift+c -》松开之后，再移动下)</span><br><span class="line"><span class="number">3.</span> 点击悬浮元素-&gt;点击下拉数据--&gt;右键--&gt;检查</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.action_chains <span class="keyword">import</span> ActionChains</span><br><span class="line">ele = driver.find_element_by_xpath(<span class="string">'定位代码'</span>)</span><br><span class="line"></span><br><span class="line">ActionChains(driver).move_to_element(ele).click(ele).perform() # 这是优化后精简的写法代码(推荐该方法)</span><br><span class="line"># 下一步：等待</span><br><span class="line"></span><br><span class="line"># ActionChains(driver).move_to_element(ele).click(ele).perform()代码类似于以下代码：</span><br><span class="line"># ele = driver.find_element_by_xpath(<span class="string">'定位代码'</span>)</span><br><span class="line"># ac = ActionChains(driver) # 实例化</span><br><span class="line"># ac.move_to_element(ele) # 悬浮</span><br><span class="line"># ac.click() # 点击</span><br><span class="line"># ac.perform() # 执行鼠标操作</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
<ol start="6">
<li>详解操作键盘<br>需要引入Key类–》from selenium.webdriver.common.keys import Keys<ol>
<li>组合键<ol>
<li>全选(ctrl+a):send_keys(Keys.CONTROL,’a’)</li>
<li>复制(ctrl+c):send_keys(Keys.CONTROL,’c’)</li>
<li>粘粘(ctrl+v):send_keys(Keys.CONTROL,’v’)</li>
<li>剪切(ctrl+x):send_keys(Keys.CONTROL,’x’)</li>
</ol>
</li>
<li>常用的非组合键<ol>
<li>回车键：Keys.ENTER</li>
<li>删除键：Keys.BACK_SPACE</li>
<li>空格键：Keys.SPACE</li>
<li>制表键：Keys.TAB</li>
<li>回退键：Keys.ESCAPE</li>
<li>刷新键：Keys.F5</li>
</ol>
</li>
<li>js之操作滚动<ol>
<li>可见/视区域–&gt; 为什么要滚动到可见区域？原因：先滚动到你要操作的元素，让其可见，然后再进行操作。</li>
<li>大部分系统在元素操作时，如果元素不在可见区域，随着操作会自动到可见区域 。<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">ele = driver.find_element_by_xpath(<span class="string">'定位代码'</span>)</span><br><span class="line">driver.execute_script(<span class="string">"arguments[0].scrollIntoView();"</span>,ele) # 页面顶端</span><br><span class="line">driver.execute_script(<span class="string">"arguments[0].scrollIntoView(false);"</span>,ele) # 页面底端</span><br><span class="line">driver.execute_script(<span class="string">"window.scrollTo(0,document.body.scrollHeight)"</span>) # 移动到页面底部</span><br><span class="line">driver.execute_script(<span class="string">"window.scrollTo(document.body.scrollHeight,0)"</span>) # 移动到页面顶部</span><br><span class="line"></span><br><span class="line">例如：</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span>  webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.wait <span class="keyword">import</span> WebDriverWait</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.implicitly_wait(<span class="number">20</span>)</span><br><span class="line">driver.maximize_window()</span><br><span class="line">driver.get (<span class="string">'https://www.ketangpai.com/User/login.html'</span>)  # 打开课堂派</span><br><span class="line"># 输入登录账号</span><br><span class="line">driver.find_element_by_xpath(<span class="string">"//input[@name='account']"</span>).clear()</span><br><span class="line">driver.find_element_by_xpath(<span class="string">"//input[@name='account']"</span>).send_keys(<span class="string">'18871369'</span>)</span><br><span class="line"># 输入登录密码</span><br><span class="line">driver.find_element_by_xpath(<span class="string">"//input[@name='pass']"</span>).clear()</span><br><span class="line">driver.find_element_by_xpath(<span class="string">"//input[@name='pass']"</span>).send_keys(<span class="string">'123456'</span>)</span><br><span class="line"># 点击登录按钮</span><br><span class="line">driver.find_element_by_xpath(<span class="string">"//div[@class='padding-cont pt-login']//a[@class='btn-btn']"</span>).click()</span><br><span class="line"># 点击进入自己的课堂</span><br><span class="line">locator = (By.XPATH,<span class="string">"//a[@data-id='MDAwMDAwMDAwMLOspd2Gz79r']"</span>)</span><br><span class="line">WebDriverWait(driver,<span class="number">20</span>).until(EC.visibility_of_element_located(locator))</span><br><span class="line">driver.find_element(*locator).click()</span><br><span class="line"></span><br><span class="line">ele = driver.find_element_by_xpath(<span class="string">"//a[contains(text(),'2019-04-19')]"</span>)</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"># driver.execute_script(<span class="string">"arguments[0].scrollIntoView();"</span>,ele) # 滑动到顶端</span><br><span class="line">driver.execute_script(<span class="string">"arguments[0].scrollIntoView(false);"</span>,ele) # 滑动到低端</span><br><span class="line"># driver.execute_script(<span class="string">"window.scrollTo(0,document.body.scrollHeight)"</span>) # 移动到页面底部</span><br><span class="line"># driver.execute_script(<span class="string">"window.scrollTo(document.body.scrollHeight,0)"</span>) # 移动到页面顶部</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">"//div[@data-id='MDAwMDAwMDAwMLSGtZaIub-y']//a[text()='查看成绩']"</span>).click()</span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-meta">本文作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Grace Soul</a></span></div><div class="post-copyright-type"><span class="post-copyright-meta">本文链接: </span><span class="post-copyright-info"><a href="https://gracesoul.github.io/2019/06/03/selenium之下拉列表-鼠标-键盘操作/">https://gracesoul.github.io/2019/06/03/selenium之下拉列表-鼠标-键盘操作/</a></span></div><div class="post-copyright-notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://gracesoul.github.io">筱茗辰</a>！</span></div></div></article><div id="pagination"><div class="prev-post pull-left"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/2019/06/04/selenium之上传文件-日期控件操作/"><i class="fas fa-angle-left">&nbsp;</i><span>selenium之上传文件,日期控件操作</span></a></div><div class="next-post pull-right"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/2019/05/29/三大等待与三大切换/"><span>三大等待与三大切换</span><span>&nbsp;</span><i class="fas fa-angle-right"></i></a></div></div><!--div!= paginator()--></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fas fa-file-o"></i></span><span id="busuanzi_value_page_pv"></span><span></span></div><div class="copyright">&copy;2017 ～ 2019 By Grace Soul</div></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/scroll.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/copy.js"></script><!--script(src=url)--><div class="search-dialog"><div id="algolia-search-title">Algolia</div><div class="search-close-button"><i class="fa fa-times"></i></div><!--div#current-refined-values--><!--div#clear-all--><div id="search-box"></div><!--div#refinement-list--><hr><div id="hits"></div><div id="algolia-pagination"></div></div><div class="search-mask"></div><script src="/js/search/algolia.js"></script></body></html>